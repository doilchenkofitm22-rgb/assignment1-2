 # Підсумковий аудит безпеки


## Виконання початкових вимог

- **AUTH‑1:** доступ до `/profile` захищено перевіркою сесії; користувачі без аутентифікації перенаправляються на сторінку входу.
- **AUTH‑2:** механізм блокування облікового запису після кількох невдалих спроб ще не реалізовано (заплановано).
- **STOR‑1:** паролі все ще зберігаються у відкритому вигляді у SQLite, що є навмисною уразливістю для тренування. Планується впровадити PBKDF2/Argon2.
- **LOG‑1:** аудит входів і помилок автентифікації поки не реалізовано. Заплановано інтеграцію з бібліотекою логування.
- **CONF‑1:** секретний ключ для сесії зберігається у змінній середовища; потрібно прибрати hard‑coded запасний варіант.

## Перегляд змін у коді

Під час ітерацій додано структуру репозиторію, опис вимог і моделі загроз. Код залишено навмисно уразливим для демонстрації SAST/DAST, проте коментарі вказують на проблемні місця. У майбутньому необхідно замінити форматовані SQL‑запити на параметризовані, додати хешування паролів та заголовки CSP/Content Security.

## Закриті вразливості

Поки що вразливості не були виправлені для цілей практики. Ризики R1–R5 залишаються відкритими та задокументовані у реєстрі. 

## Ролі та відповідальність

- **Owner:** визначає бачення продукту, бюджет і приймає рішення щодо пріоритетів безпеки; затверджує політики та виділяє ресурси.
- **Security Champion:** координує активності з безпеки в команді, проводить навчання, контролює виконання SAST/DAST, стежить за виправленнями.
- **Dev (розробник):** пише код з урахуванням найкращих практик, виправляє знайдені уразливості, додає тестові сценарії.
- **QA:** виконує тестування, у тому числі безпекове, перевіряє усунення уразливостей, створює баг‑репорти.
- **DevOps:** налаштовує CI/CD, інтегрує SAST/DAST у пайплайни, керує секретами та інфраструктурою.

## Рекомендації  

1. **Виправити SQL‑інʼєкцію:** замінити форматовані рядки на параметризовані запити або ORM; додати валідацію параметрів.
2. **Усути XSS:** екранувати всі користувацькі дані у шаблонах; впровадити Content Security Policy.
3. **Покращити автентифікацію:** зберігати хешовані паролі з солью; додати обмеження спроб і 2FA для адміністраторів.
4. **Додати безпекові заголовки:** `X-Frame-Options`, `X-Content-Type-Options`, `Referrer-Policy`, `Strict-Transport-Security`.
5. **Відстеження залежностей:** інтегрувати `pip-audit` або Trivy для аналізу залежностей та контейнерів; налаштувати автоматичні сповіщення про CVE.
6. **Secret scanning:** увімкнути перевірку секретів у репозиторії (наприклад, GitHub secret scanning) та уникати публікації ключів.
7. **Ітераційне вдосконалення:**  поступово виправляти знайдені уразливості, оновлювати реєстр ризиків та модифікувати процеси з урахуванням отриманого досвіду.
